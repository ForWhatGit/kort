<!DOCTYPE html>
<html lang="en">
	<head>
		<%- include('partials/header.ejs') %>
		<%- include('partials/datatables.ejs') %>
		<title>Kort: Studies</title>
	 	<script type="text/javascript" src="/js/studies.js"></script>
	</head>
	<body>
	<%- include('partials/admin_header.ejs') %>
	<div class="container">
		<div class="row">
			<div class="col-md-4">
				<h1>Studies</h1>
				<p>Create, edit, and delete studies.</p>
			</div>
			<div class="col-md-4 col-md-offset-4">
				<div class="btn-group float-right">
				    <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown">New Study</button>
				    <ul class="dropdown-menu pull-right" role="menu">
				      <li><a href="/createcardsort">Card Sort</a></li>
				      <li><a href="/createtreetest">Tree Test</a></li>
				      <li><a href="/createproductreactioncards">Product Reaction Cards</a></li>
				    </ul>
			  	</div>
			</div>
		</div>
		<br>
		<div class="row">
		  	<table class="table" id='studies_table'>
				<thead>
					<tr class='active'>
						<th>Name</th>
						<th>Status</th>
						<th>Type</th>
						<th># of Responses</th>
						<th></th>
						<th></th>
						<th></th>
						<th></th>
						<th></th>
					</tr>
				</thead>
				<tbody id="studies_table_body">
				<% for(var i=0; i<studies.length; i++) {%>
					<tr>
						<td><%=studies[i].title %></td>
						<td data-status="<%=studies[i].status %>"><%=studies[i].status %></td>
						<td data-type='<%=studies[i].type %>'></td>
						<td><%=studies[i].completeResponses.length %></td>
						<td><a href="/study/copy/<%= studies[i]._id %>">Copy</a></td>
						<%if (studies[i].type == 'cardsort') { %>
							<td><a href="/cardsort/preview/<%= studies[i]._id %>">Preview</a></td>
							<%if (studies[i].completeResponses.length > 0) { %>
							<td><a href="/cardsortresults/<%= studies[i]._id %>">Results</a></td>
							<% } else { %>
							<td><a class="text-muted"  href="#" data-toggle="tooltip" title="Results not available until at least one submission completed.">Results</a></td>
							<% } %>
							<td><a href="/editcardsort/<%= studies[i]._id %>">Edit</a></td>
						<% } %>
						<%if (studies[i].type == 'treetest') { %>
							<td><a href="/treetest/preview/<%= studies[i]._id %>">Preview</a></td>
							<%if (studies[i].completeResponses.length > 0) { %>
							<td><a href="/treetestresults/<%= studies[i]._id %>">Results</a></td>
							<% } else { %>
							<td><a class="text-muted"  href="#" data-toggle="tooltip" title="Results not available until at least one submission completed.">Results</a></td>
							<% } %>
							<td><a href="/edittreetest/<%= studies[i]._id %>">Edit</a></td>
						<% } %>
						<%if (studies[i].type == 'productreactioncards') { %>
							<td><a href="/productreactioncards/preview/<%= studies[i]._id %>">Preview</a></td>
							<%if (studies[i].completeResponses.length > 0) { %>
								<td><a href="/productreactioncardsresults/<%= studies[i]._id %>">Results</a></td>
							<% } else { %>
								<td><a class="text-muted"  href="#" data-toggle="tooltip" title="Results not available until at least one submission completed.">Results</a></td>
							<% } %>
							<td><a href="/editproductreactioncards/<%= studies[i]._id %>">Edit</a></td>
						<% } %>
						<td><a href='#' data-studyid="<%= studies[i]._id %>" data-title="<%=studies[i].title %>" class="text-danger">Delete</a></td>
					</tr>
				<% } %>
				</tbody>
			</table>
		</div>
  	</div>
	</body>
</html>
